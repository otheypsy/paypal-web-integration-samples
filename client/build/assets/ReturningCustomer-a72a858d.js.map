{"version":3,"file":"ReturningCustomer-a72a858d.js","sources":["../../src/app/braintree/pages/client/BTPwPPCheckoutVault/sections/ReturningCustomer.jsx"],"sourcesContent":["import PropTypes from 'prop-types'\nimport { useState, useRef } from 'react'\nimport BTPayPalCheckout from 'braintree-web/paypal-checkout'\nimport withOperations from '../../../../../../layouts/withOperations.component.jsx'\nimport { log, danger } from '../../../../../../integrations/services/LoggerService.jsx'\nimport { serverInterface } from '../../../../../../services/bt.service.jsx'\nimport { useAddBusy, useRemoveBusy } from '../../../../../../states/Busy/busy.hooks.jsx'\nimport { useSetError } from '../../../../../../states/Error/error.hooks.jsx'\nimport { useAppContext } from '../../../../../../states/AppContext/appContext.hooks.jsx'\nimport { useAddOutput } from '../../../../../../states/Output/output.hooks.jsx'\n\nconst _operations = {\n    paypalCheckoutCreate: {\n        label: 'braintree-web.paypalCheckout.create(options, callback)',\n        type: 'client',\n        data: {\n            options: {\n                client: 'CLIENT_INSTANCE_HERE',\n                autoSetDataUserIdToken: true,\n            },\n        },\n    },\n    loadPayPalSDK: {\n        label: 'paypalCheckoutInstance.loadPayPalSDK(options, callback)',\n        type: 'client',\n        data: {\n            options: {\n                currency: 'USD',\n                intent: 'capture',\n                'disable-funding': 'card',\n                dataAttributes: {\n                    amount: '100.00',\n                    commit: true,\n                },\n            },\n        },\n    },\n    renderPayPalButtons: {\n        label: 'window.paypal.Buttons(config).render',\n        type: 'client',\n        data: {\n            config: {\n                style: {\n                    layout: 'vertical',\n                    color: 'gold',\n                    shape: 'rect',\n                    label: 'paypal',\n                    tagline: false,\n                },\n            },\n        },\n    },\n    createPayment: {\n        label: 'paypalCheckoutInstance.createPayment(options, callback)',\n        type: 'client',\n        data: {\n            options: {\n                flow: 'checkout',\n                intent: 'capture',\n                amount: '100.00',\n                currency: 'USD',\n                enableShippingAddress: true,\n                shippingAddressEditable: true,\n            },\n        },\n    },\n    tokenizePayment: {\n        label: 'paypalCheckoutInstance.tokenizePayment(tokenizeOptions, callback)',\n        type: 'client',\n        data: {\n            tokenizeOptions: {},\n        },\n    },\n    transactionSale: {\n        label: 'gateway.transaction.sale(parameters, callback)',\n        type: 'server',\n        data: {\n            parameters: {\n                amount: '100.00',\n                merchantAccountId: 'odesai_USD',\n                paymentMethodNonce: 'NONCE_HERE',\n                deviceData: 'DEVICE_DATA_HERE',\n                options: {\n                    submitForSettlement: true,\n                },\n            },\n        },\n    },\n}\n\nconst PayPalReact = {\n    Component: () => null,\n}\n\nconst ReturningCustomer = (props) => {\n    const ppContainer = useRef()\n    const [ppInstance, setPPInstance] = useState(undefined)\n    const addBusy = useAddBusy()\n    const removeBusy = useRemoveBusy()\n    const addOutput = useAddOutput()\n    const setError = useSetError()\n    const appContext = useAppContext()\n\n    const createPayPalInstance = async () => {\n        addBusy()\n        try {\n            const response = await BTPayPalCheckout.create({\n                ...props.operations.paypalCheckoutCreate.data.options,\n                client: appContext['clientInstance'],\n            })\n            log('ReturningCustomer: createPayPalInstance', response)\n            setPPInstance(response)\n        } catch (error) {\n            setError()\n            danger('ReturningCustomer: createPayPalInstance', error)\n        }\n        removeBusy()\n    }\n\n    const loadPayPalSDK = async () => {\n        addBusy()\n        await ppInstance.loadPayPalSDK(props.operations.loadPayPalSDK.data.options)\n        removeBusy()\n    }\n\n    const renderPayPalButtons = async () => {\n        addBusy()\n        await window.paypal\n            .Buttons({\n                ...props.operations.renderPayPalButtons.data.config,\n                createOrder: createOrder,\n                onApprove: onApprove,\n                onClick: () => console.log('PayPalCheckout: onClick'),\n                onInit: () => console.log('PayPalCheckout: onInit'),\n                onCancel: (error) => console.error('PayPalCheckout: onCancel', error),\n                onError: (error) => console.error('PayPalCheckout: onError', error),\n            })\n            .render(ppContainer.current)\n        removeBusy()\n    }\n\n    const createOrder = async () => {\n        let response = undefined\n        addBusy()\n        try {\n            response = await ppInstance.createPayment(props.operations.createPayment.data.options)\n            log('ReturningCustomer: createOrder', response)\n        } catch (error) {\n            danger('ReturningCustomer: onApprove', error)\n        }\n        removeBusy()\n        return response\n    }\n\n    const onApprove = async (data) => {\n        addBusy()\n        try {\n            const response = await ppInstance.tokenizePayment(data)\n            log('ReturningCustomer: onApprove', response)\n            addOutput('Payload', response)\n        } catch (error) {\n            danger('ReturningCustomer: onApprove', error)\n        }\n        removeBusy()\n    }\n\n    const ppConfig = {\n        ...props.operations.renderPayPalButtons.data.config,\n        createOrder: createOrder,\n        onApprove: onApprove,\n        onClick: () => console.log('PayPalCheckout: onClick'),\n        onInit: () => console.log('PayPalCheckout: onInit'),\n        onCancel: (error) => console.error('PayPalCheckout: onCancel', error),\n        onError: (error) => console.error('PayPalCheckout: onError', error),\n    }\n\n    const createTransaction = async () => {\n        addBusy()\n        try {\n            const response = await serverInterface(\n                'transaction',\n                'sale',\n                [],\n                props.operations.transactionSale.data.parameters,\n            )\n            log('ReturningCustomer: createTransaction', response)\n            addOutput('Transaction', response)\n        } catch (error) {\n            danger('ReturningCustomer: onApprove', error)\n        }\n        removeBusy()\n    }\n\n    return (\n        <>\n            <button className=\"btn btn-outline-success\" onClick={createPayPalInstance}>\n                Create PayPal Instance\n            </button>\n            <br />\n            <br />\n            <button className=\"btn btn-outline-success\" onClick={loadPayPalSDK}>\n                Load PayPal JS SDK\n            </button>\n            <br />\n            <br />\n            <button className=\"btn btn-outline-success\" onClick={renderPayPalButtons}>\n                Render PayPal Buttons\n            </button>\n            <br />\n            <br />\n            <div ref={ppContainer} />\n            <br />\n            <br />\n            <button className=\"btn btn-outline-success\" onClick={createTransaction}>\n                Create Transaction\n            </button>\n            <br />\n            <br />\n            <PayPalReact.Component {...ppConfig} />\n        </>\n    )\n}\n\nReturningCustomer.propTypes = {\n    operations: PropTypes.object,\n}\n\nexport default withOperations(ReturningCustomer, _operations)\n"],"names":["_operations","PayPalReact","ReturningCustomer","props","ppContainer","useRef","ppInstance","setPPInstance","useState","addBusy","useAddBusy","removeBusy","useRemoveBusy","addOutput","useAddOutput","setError","useSetError","appContext","useAppContext","createPayPalInstance","response","BTPayPalCheckout","log","error","danger","loadPayPalSDK","renderPayPalButtons","createOrder","onApprove","data","ppConfig","jsxs","Fragment","jsx","serverInterface","PropTypes","ReturningCustomer$1","withOperations"],"mappings":"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"}