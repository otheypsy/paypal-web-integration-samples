import{r as p,j as i,P,d as v,e as S,f as C,b as w,F as B}from"./index-0012b4da.js";import{w as E}from"./withOperations.component-67facef3.js";import{c as g}from"./logger.utils-ababba19.js";import{j as k}from"./http.utils-58ed8dbd.js";import"./InputText.component-59d8abb9.js";const O=(t,r={},o={})=>new Promise((e,a)=>{const n=document.createElement("script"),l=new URL(t);for(const c in r)l.searchParams.append(c,r[c]);for(const c in o)n.setAttribute(c,o[c]);const u=()=>{e(n),n.removeEventListener("error",s),n.removeEventListener("load",u)},s=c=>{a(c),n.removeEventListener("error",s),n.removeEventListener("load",u)};n.src=l.href,n.async=!0,document.body.appendChild(n),n.addEventListener("load",u),n.addEventListener("error",s)}),L=async(t={},r={})=>{const o={components:"buttons,funding-eligibility","client-id":"test","disable-funding":"card",...t};return await O("https://www.paypal.com/sdk/js",o,r)},A=async(t,r,o={},e={})=>{const a="/api/paypal/rest/interface",n=localStorage.getItem("authHeader")?{authorization:"Basic "+localStorage.getItem("authHeader")}:{},l={uri:t,headers:e,body:o};return await k[r.toLowerCase()](a,l,n)},{log:d,error:f,warn:j}=g("PayPalButtons.component.js"),b=t=>{const r=p.useRef(),o=p.useMemo(()=>({style:{color:"black",layout:"vertical",shape:"rect",label:"paypal",tagline:"false"},onClick:(e,a)=>d("PayPalButtons: onClick",{data:e,actions:a}),onInit:(e,a)=>d("PayPalButtons: onInit",{data:e,actions:a}),createOrder:(e,a)=>d("PayPalButtons: createOrder",{data:e,actions:a}),onApprove:(e,a)=>d("PayPalButtons: onApprove",{data:e,actions:a}),onCancel:e=>f("PayPalButtons: onCancel",e),onError:e=>f("PayPalButtons: onError",e),...t.ppConfig}),[t.ppConfig]);return p.useEffect(()=>{const e=r.current;return o&&(async()=>{const n=t.fundingSources||window.paypal.getFundingSources();d(t.fundingSources);for(const l of n){const u=window.paypal.Buttons({...o,fundingSource:l});try{u.isEligible()&&e&&await u.render(e)}catch(s){j("PayPalButtons",s.message)}}})(),()=>{window.paypal.Buttons.instances.forEach(n=>n.close()),e.innerHTML=null}},[o,t.fundingSources]),i("div",{ref:r})},h=t=>t.ppConfig&&window?.paypal?.Buttons?i(b,{ppConfig:t.ppConfig,fundingSources:t.fundingSources}):null;b.propTypes=h.propTypes={ppConfig:P.object,fundingSources:P.array};const{log:m,error:y}=g("PPCheckout.component.jsx"),D={loadPayPalSDK:{label:"Load PayPal JS SDK",type:"client",data:{options:{},dataAttributes:{}}},createOrder:{label:"Create Order",type:"server",data:{uri:"v2/checkout/orders",method:"POST",body:{intent:"CAPTURE",purchase_units:[{invoice_id:"INV-"+Math.round(new Date().getTime()/1e3),amount:{currency_code:"USD",value:"220.00"}}]}}},onApprove:{label:"Execute Order",type:"server",data:{uri:"v2/checkout/orders",method:"POST",body:{}}}},T=t=>{const r=v(),o=S(),e=C(),[a,n]=p.useState(void 0),l=async()=>{r();const{options:s,dataAttributes:c}=t.operations.loadPayPalSDK.data;await L(s,c),o()},u=()=>{if(r(),!window?.paypal?.Buttons)return y("renderPayPalButtons","Unable to load PayPal Checkout SDK");n({createOrder:async()=>{r();let s;try{s=await A(t.operations.createOrder.data.uri,t.operations.createOrder.data.method,t.operations.createOrder.data.body),m("createOrder",s)}catch(c){e(),y("createOrder",c)}return o(),s?.id},onApprove:async s=>{r();try{m("onApprove",s)}catch(c){e(),y("onApprove",c)}o()}}),o()};return w(B,{children:[i("button",{className:"btn btn-outline-success",onClick:l,children:"Load PayPal JS SDK"}),i("br",{}),i("button",{className:"btn btn-outline-success",onClick:u,children:"Render PayPal Buttons"}),i("br",{}),i("button",{className:"btn btn-outline-success",onClick:u,children:"Execute Order"}),i("br",{}),i("br",{}),i(h,{ppConfig:a,fundingSources:["paypal"]})]})},_=E(T,D);export{_ as default};
//# sourceMappingURL=PPCheckout.component-1df1dffe.js.map
