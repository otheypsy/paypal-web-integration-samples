{"version":3,"file":"Checkout-036a4340.js","sources":["../../src/app/braintree/pages/client/BTPwPPCheckout/sections/Checkout.jsx"],"sourcesContent":["import PropTypes from 'prop-types'\nimport { useState, useRef } from 'react'\nimport BTPayPalCheckout from 'braintree-web/paypal-checkout'\nimport withOperations from '../../../../../../layouts/withOperations.hoc.jsx'\nimport { serverInterface } from '../../../../../../services/bt.service.jsx'\nimport { useAddBusy, useRemoveBusy } from '../../../../../../states/Busy/busy.hooks.jsx'\nimport { useAddOutput } from '../../../../../../states/Output/output.hooks.jsx'\nimport { useSetError } from '../../../../../../states/Error/error.hooks.jsx'\nimport { useAppContext } from '../../../../../../states/AppContext/appContext.hooks.jsx'\nimport { log, warning, danger } from '../../../../../../integrations/services/LoggerService.jsx'\n\nconst _operations = {\n    paypalCheckoutCreate: {\n        label: 'braintree-web.paypalCheckout.create(options, callback)',\n        type: 'client',\n        data: {\n            options: {\n                client: 'CLIENT_INSTANCE_HERE',\n            },\n        },\n    },\n    loadPayPalSDK: {\n        label: 'paypalCheckoutInstance.loadPayPalSDK(options, callback)',\n        type: 'client',\n        data: {\n            options: {\n                currency: 'USD',\n                intent: 'capture',\n                'disable-funding': 'card',\n            },\n        },\n    },\n    renderPayPalButtons: {\n        label: 'window.paypal.Buttons(config).render',\n        type: 'client',\n        data: {\n            config: {\n                style: {\n                    layout: 'vertical',\n                    color: 'gold',\n                    shape: 'rect',\n                    label: 'paypal',\n                    tagline: false,\n                },\n            },\n        },\n    },\n    createPayment: {\n        label: 'paypalCheckoutInstance.createPayment(options, callback)',\n        type: 'client',\n        data: {\n            options: {\n                flow: 'checkout',\n                intent: 'capture',\n                amount: '100.00',\n                currency: 'USD',\n                enableShippingAddress: true,\n                shippingAddressEditable: true,\n            },\n        },\n    },\n    tokenizePayment: {\n        label: 'paypalCheckoutInstance.tokenizePayment(tokenizeOptions, callback)',\n        type: 'client',\n        data: {\n            tokenizeOptions: {},\n        },\n    },\n    transactionSale: {\n        label: 'gateway.transaction.sale(parameters, callback)',\n        type: 'server',\n        data: {\n            parameters: {\n                amount: '100.00',\n                merchantAccountId: 'odesai_USD',\n                paymentMethodNonce: 'NONCE_HERE',\n                options: {\n                    submitForSettlement: true,\n                },\n            },\n        },\n    },\n}\n\nconst _requiredContext = ['clientInstance']\n\nconst Checkout = (props) => {\n    const addBusy = useAddBusy()\n    const removeBusy = useRemoveBusy()\n    const addOutput = useAddOutput()\n    const setError = useSetError()\n    const appContext = useAppContext()\n    const ppContainer = useRef()\n    const [ppInstance, setPPInstance] = useState(undefined)\n    const [nonce, setNonce] = useState(undefined)\n\n    const createPayPalInstance = async () => {\n        addBusy()\n        try {\n            const response = await BTPayPalCheckout.create({\n                client: appContext.clientInstance,\n            })\n            log('Checkout: createPayPalInstance', response)\n            setPPInstance(response)\n        } catch (error) {\n            setError()\n            danger('NewCustomer: createPayPalInstance', error)\n        }\n        removeBusy()\n    }\n\n    const loadPayPalSDK = async () => {\n        addBusy()\n        await ppInstance.loadPayPalSDK(props.operations.loadPayPalSDK.data.options)\n        removeBusy()\n    }\n\n    const renderPayPalButtons = async () => {\n        addBusy()\n        try {\n            if (!window?.paypal?.Buttons) throw Error('PayPal JS SDK not found')\n            const ppConfig = createPayPalPConfig()\n            ppContainer.current.innerHTML = null\n            await window.paypal.Buttons(ppConfig).render(ppContainer.current)\n        } catch (error) {\n            setError()\n            danger('NewCustomer: renderPayPalButtons', error)\n        }\n        removeBusy()\n    }\n\n    const createPayPalPConfig = () => {\n        return {\n            ...props.operations.renderPayPalButtons.data.config,\n            fundingSource: window.paypal.FUNDING.PAYPAL,\n\n            createOrder: async () => {\n                addBusy()\n                let response = undefined\n                try {\n                    response = await ppInstance.createPayment(props.operations.createPayment.data.options)\n                    log('createOrder', response)\n                } catch (error) {\n                    setError()\n                    danger('createOrder', error)\n                }\n                removeBusy()\n                return response\n            },\n\n            onApprove: async (data) => {\n                addBusy()\n                try {\n                    log('onApprove', data)\n                    const response = await ppInstance.tokenizePayment(data)\n                    log('tokenizePayment', response)\n                    addOutput('TokenizePayment', response)\n                    setNonce(response.nonce)\n                } catch (error) {\n                    setError()\n                    danger('onApprove', error)\n                }\n                removeBusy()\n            },\n\n            onClick: (...args) => log('PayPalCheckout: onClick', { ...args }),\n            onInit: (...args) => log('PayPalCheckout: onInit', { ...args }),\n            onCancel: (error) => warning('PayPalCheckout: onCancel', error),\n            onError: (error) => danger('PayPalCheckout: onError', error),\n        }\n    }\n\n    const createTransaction = async () => {\n        addBusy()\n        try {\n            const params = {\n                ...props.operations.transactionSale.data.parameters,\n                paymentMethodNonce: nonce,\n            }\n            const response = await serverInterface('transaction', 'sale', [], params)\n            log('Checkout: createTransaction', response)\n            addOutput('TransactionSale', response)\n        } catch (error) {\n            setError()\n            danger('Checkout: createTransaction', error)\n        }\n        removeBusy()\n    }\n\n    return (\n        <>\n            <button className=\"btn btn-outline-success\" onClick={createPayPalInstance}>\n                Create PayPal Instance\n            </button>\n            <br />\n            <br />\n            <button className=\"btn btn-outline-success\" onClick={loadPayPalSDK}>\n                Load PayPal JS SDK\n            </button>\n            <br />\n            <br />\n            <button className=\"btn btn-outline-success\" onClick={renderPayPalButtons}>\n                Render PayPal Buttons\n            </button>\n            <br />\n            <br />\n            <div ref={ppContainer} />\n            <br />\n            <br />\n            <button className=\"btn btn-outline-success\" onClick={createTransaction}>\n                Create Transaction\n            </button>\n        </>\n    )\n}\n\nCheckout.propTypes = {\n    operations: PropTypes.object,\n}\n\nexport default withOperations(Checkout, _operations, _requiredContext)\n"],"names":["_operations","_requiredContext","Checkout","props","addBusy","useAddBusy","removeBusy","useRemoveBusy","addOutput","useAddOutput","setError","useSetError","appContext","useAppContext","ppContainer","useRef","ppInstance","setPPInstance","useState","nonce","setNonce","createPayPalInstance","response","BTPayPalCheckout","log","error","danger","loadPayPalSDK","renderPayPalButtons","ppConfig","createPayPalPConfig","data","args","warning","jsxs","Fragment","jsx","params","serverInterface","PropTypes","Checkout$1","withOperations"],"mappings":"4XAWA,MAAMA,EAAc,CAChB,qBAAsB,CAClB,MAAO,yDACP,KAAM,SACN,KAAM,CACF,QAAS,CACL,OAAQ,sBACZ,CACJ,CACJ,EACA,cAAe,CACX,MAAO,0DACP,KAAM,SACN,KAAM,CACF,QAAS,CACL,SAAU,MACV,OAAQ,UACR,kBAAmB,MACvB,CACJ,CACJ,EACA,oBAAqB,CACjB,MAAO,uCACP,KAAM,SACN,KAAM,CACF,OAAQ,CACJ,MAAO,CACH,OAAQ,WACR,MAAO,OACP,MAAO,OACP,MAAO,SACP,QAAS,EACb,CACJ,CACJ,CACJ,EACA,cAAe,CACX,MAAO,0DACP,KAAM,SACN,KAAM,CACF,QAAS,CACL,KAAM,WACN,OAAQ,UACR,OAAQ,SACR,SAAU,MACV,sBAAuB,GACvB,wBAAyB,EAC7B,CACJ,CACJ,EACA,gBAAiB,CACb,MAAO,oEACP,KAAM,SACN,KAAM,CACF,gBAAiB,CAAC,CACtB,CACJ,EACA,gBAAiB,CACb,MAAO,iDACP,KAAM,SACN,KAAM,CACF,WAAY,CACR,OAAQ,SACR,kBAAmB,aACnB,mBAAoB,aACpB,QAAS,CACL,oBAAqB,EACzB,CACJ,CACJ,CACJ,CACJ,EAEMC,EAAmB,CAAC,gBAAgB,EAEpCC,EAAYC,GAAU,CACxB,MAAMC,EAAUC,IACVC,EAAaC,IACbC,EAAYC,IACZC,EAAWC,IACXC,EAAaC,IACbC,EAAcC,EAAAA,SACd,CAACC,EAAYC,CAAa,EAAIC,EAAAA,SAAS,MAAS,EAChD,CAACC,EAAOC,CAAQ,EAAIF,EAAAA,SAAS,MAAS,EAEtCG,EAAuB,SAAY,CAC7BjB,IACJ,GAAA,CACM,MAAAkB,EAAW,MAAMC,EAAiB,OAAO,CAC3C,OAAQX,EAAW,cAAA,CACtB,EACDY,EAAI,iCAAkCF,CAAQ,EAC9CL,EAAcK,CAAQ,QACjBG,GACIf,IACTgB,EAAO,oCAAqCD,CAAK,CACrD,CACWnB,GAAA,EAGTqB,EAAgB,SAAY,CACtBvB,IACR,MAAMY,EAAW,cAAcb,EAAM,WAAW,cAAc,KAAK,OAAO,EAC/DG,GAAA,EAGTsB,EAAsB,SAAY,CAC5BxB,IACJ,GAAA,CACI,GAAA,CAAC,QAAQ,QAAQ,QAAS,MAAM,MAAM,yBAAyB,EACnE,MAAMyB,EAAWC,IACjBhB,EAAY,QAAQ,UAAY,KAChC,MAAM,OAAO,OAAO,QAAQe,CAAQ,EAAE,OAAOf,EAAY,OAAO,QAC3DW,GACIf,IACTgB,EAAO,mCAAoCD,CAAK,CACpD,CACWnB,GAAA,EAGTwB,EAAsB,KACjB,CACH,GAAG3B,EAAM,WAAW,oBAAoB,KAAK,OAC7C,cAAe,OAAO,OAAO,QAAQ,OAErC,YAAa,SAAY,CACbC,IACR,IAAIkB,EACA,GAAA,CACAA,EAAW,MAAMN,EAAW,cAAcb,EAAM,WAAW,cAAc,KAAK,OAAO,EACrFqB,EAAI,cAAeF,CAAQ,QACtBG,GACIf,IACTgB,EAAO,cAAeD,CAAK,CAC/B,CACW,OAAAnB,IACJgB,CACX,EAEA,UAAW,MAAOS,GAAS,CACf3B,IACJ,GAAA,CACAoB,EAAI,YAAaO,CAAI,EACrB,MAAMT,EAAW,MAAMN,EAAW,gBAAgBe,CAAI,EACtDP,EAAI,kBAAmBF,CAAQ,EAC/Bd,EAAU,kBAAmBc,CAAQ,EACrCF,EAASE,EAAS,KAAK,QAClBG,GACIf,IACTgB,EAAO,YAAaD,CAAK,CAC7B,CACWnB,GACf,EAEA,QAAS,IAAI0B,IAASR,EAAI,0BAA2B,CAAE,GAAGQ,EAAM,EAChE,OAAQ,IAAIA,IAASR,EAAI,yBAA0B,CAAE,GAAGQ,EAAM,EAC9D,SAAWP,GAAUQ,EAAQ,2BAA4BR,CAAK,EAC9D,QAAUA,GAAUC,EAAO,0BAA2BD,CAAK,CAAA,GAqBnE,OAEQS,EAAAC,EAAA,CAAA,SAAA,CAAAC,EAAC,SAAO,CAAA,UAAU,0BAA0B,QAASf,EAAsB,SAE3E,yBAAA,IACC,KAAG,EAAA,IACH,KAAG,EAAA,IACH,SAAO,CAAA,UAAU,0BAA0B,QAASM,EAAe,SAEpE,qBAAA,IACC,KAAG,EAAA,IACH,KAAG,EAAA,IACH,SAAO,CAAA,UAAU,0BAA0B,QAASC,EAAqB,SAE1E,wBAAA,IACC,KAAG,EAAA,IACH,KAAG,EAAA,EACJQ,EAAC,MAAI,CAAA,IAAKtB,CAAa,CAAA,IACtB,KAAG,EAAA,IACH,KAAG,EAAA,IACH,SAAO,CAAA,UAAU,0BAA0B,QArC1B,SAAY,CAC1BV,IACJ,GAAA,CACA,MAAMiC,EAAS,CACX,GAAGlC,EAAM,WAAW,gBAAgB,KAAK,WACzC,mBAAoBgB,CAAA,EAElBG,EAAW,MAAMgB,EAAgB,cAAe,OAAQ,CAAA,EAAID,CAAM,EACxEb,EAAI,8BAA+BF,CAAQ,EAC3Cd,EAAU,kBAAmBc,CAAQ,QAChCG,GACIf,IACTgB,EAAO,8BAA+BD,CAAK,CAC/C,CACWnB,GAAA,EAuBiE,SAExE,qBAAA,CACJ,CAAA,CAAA,CAER,EAEAJ,EAAS,UAAY,CACjB,WAAYqC,EAAU,MAC1B,EAEA,MAAAC,EAAeC,EAAevC,EAAUF,EAAaC,CAAgB"}